<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Puntuaciones</title>
    <link rel="stylesheet" type="text/css" href="../node_modules/bootswatch/dist/cerulean/bootstrap.min.css">
    <!-- Insert this line above script imports  -->
    <script>
        if (typeof module === 'object') {
            window.module = module; module = undefined
        }
    </script>
    <!-- normal script imports etc  -->
    <script src="../node_modules/jquery/dist/jquery.slim.min.js"></script>
    <script src="../node_modules/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../node_modules/bootstrap/dist/js/bootstrap.min.js"></script>

    <!-- Insert this line after script imports -->
    <script>
        if (window.module) module = window.module;
    </script>
    <style>
        caption {
            caption-side: top;
        }
    </style>
</head>

<body>
    <h3 class="text-center" id="tituloJuego">

    </h3>
    <table class="table table-striped table-hover table-bordered" id="tabla">
    </table>
    <script>
        const { ipcRenderer } = require('electron');
        let nombreJuego;
        ipcRenderer.on('juego', (evt, juego) => {
            creacionStorage(juego);
            creacionTabla(juego);
            document.getElementById("tituloJuego").textContent = juego;
        });
        function creacionStorage(juego) {
            localStorage.setItem(juego, JSON.stringify(
                [
                    {
                        "nombre": "san",
                        "puntuacion": 123312
                    },
                    {
                        "nombre": "alb",
                        "puntuacion": 123123123
                    },
                    {
                        "nombre": "and",
                        "puntuacion": 4567867
                    }
                ]
            ));
        }

        function creacionTabla(juego) {
            let objeto = JSON.parse(localStorage.getItem(juego));
            if (!objeto) {
                $('body').empty();
                $(`<div class="alert alert-primary" role="alert">
                ${juego}
                </div>'`).appendTo($('body'));
            } else {
                objeto.sort((a, b) => {
                    if (a.puntuacion > b.puntuacion) {
                        return -1;
                    } else if (a.puntuacion < b.puntuacion) {
                        return 1;
                    } else {
                        return 0;
                    }
                });
                let tabla = document.getElementById("tabla");
                $(`<tr><th scope="col">Puesto</th><th scope="col">Nombre</th><th scope="col">Puntuacion</th></tr>`).appendTo("#tabla");
                $("<tbody></tbody>").appendTo("#tabla");
                for (let i = 1; i < objeto.length + 1; i++) {
                    $(`<tr><th scope="row">${i}</th><td>${objeto[i - 1].nombre}</td><td>${objeto[i - 1].puntuacion}</td></tr>`).appendTo("tbody");
                }
            }
        }



    </script>
</body>

</html>